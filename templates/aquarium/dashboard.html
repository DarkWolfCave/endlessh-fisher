{% extends "base.html" %}
{% load game_tags %}

{% block title %}Dashboard - {{ GAME_NAME }}{% endblock %}

{% block content %}
<!-- Live Pond (main feature, HTMX polling every 15s) -->
<h2 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 1rem; color: var(--color-accent);">
    &#x1F30A; Live-Teich &mdash; Aktuell gefangene Bots
</h2>
<div class="live-pond-container" style="margin-bottom: 2rem;"
     id="live-pond-container"
     hx-get="{% url 'htmx:live-pond' %}"
     hx-trigger="every 15s"
     hx-swap="innerHTML">
    {% include "components/live_pond.html" %}
</div>

<!-- Server Ponds -->
<h2 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 1rem; color: var(--color-accent);">
    &#x1F3A3; Angelteiche
</h2>
<div class="grid-ponds" style="margin-bottom: 2rem;">
    {% for server in servers %}
        {% include "components/server_pond.html" with server=server %}
    {% endfor %}
</div>

<!-- Bottom Section: Activity Feed + Stats -->
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
    <!-- Activity Feed -->
    <div class="game-card">
        <h3 style="font-weight: 700; margin-bottom: 1rem; color: var(--color-accent);">
            &#x1F4E1; Live-Fänge
        </h3>
        <div hx-get="{% url 'htmx:activity-feed' %}"
             hx-trigger="every 15s"
             hx-swap="innerHTML">
            {% include "components/activity_feed.html" %}
        </div>
    </div>

    <!-- Quick Stats -->
    <div class="game-card">
        <h3 style="font-weight: 700; margin-bottom: 1rem; color: var(--color-accent);">
            &#x1F4CA; Statistiken
        </h3>
        <div style="display: grid; gap: 1rem;">
            <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: var(--color-surface-2); border-radius: 0.5rem;">
                <span style="color: var(--color-text-muted);">Gesamt-Fänge</span>
                <span style="font-weight: 700; color: var(--color-accent);">{{ total_catches|score_format }}</span>
            </div>
            <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: var(--color-surface-2); border-radius: 0.5rem;">
                <span style="color: var(--color-text-muted);">Aktuell in Falle</span>
                <span style="font-weight: 700; color: var(--color-uncommon);">{{ active_traps }}</span>
            </div>
            <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: var(--color-surface-2); border-radius: 0.5rem;">
                <span style="color: var(--color-text-muted);">Verschwendete Zeit</span>
                <span style="font-weight: 700; color: var(--color-epic);">{{ total_trapped_seconds|duration_format }}</span>
            </div>
            <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: var(--color-surface-2); border-radius: 0.5rem;">
                <span style="color: var(--color-text-muted);">Verschiedene Länder</span>
                <span style="font-weight: 700; color: var(--color-rare);">{{ total_countries }}</span>
            </div>
            <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: var(--color-surface-2); border-radius: 0.5rem;">
                <span style="color: var(--color-text-muted);">Gesamt-Score</span>
                <span style="font-weight: 700; color: var(--color-legendary);">{{ total_score|score_format }}</span>
            </div>
        </div>
    </div>
</div>
{% endblock %}
